/* ===================================================================
   BUTTON COMPONENT
   Modern, accessible button with multiple variants and states.
   ===================================================================

   Variants supported:
   ðŸŽ¨ Color: primary, secondary, success, danger, warning, info, notice, muted
   âœ³ï¸ State: loading, disabled, focus, active
   ðŸ†Ž Style: filled, ghost, outline, light, gradient, pill, glow
   ðŸ“ Size: xs, sm, md, lg, xl, xxl, block, icon
*/


.button {
  /* --- Component Variables --- */
  /* These are the defaults, representing the primary button. */
  /* Variants will override these as needed. */
  --button-bg: var(--color-primary);
  --button-text: var(--white);
  --button-border-color: transparent;
  --button-bg-hover: var(--color-primary-dark);
  --button-text-hover: var(--white);
  --button-border-color-hover: transparent;
  --button-focus-color: rgba(from var(--color-primary) r g b / 0.5);
  --button-glow-color: var(--color-primary);
  --button-gradient-start: var(--color-primary);
  --button-gradient-end: var(--color-primary-dark);
  --button-border-radius: 0.375em; /* Proportionate radius based on font size */

  /* --- Base Styles --- */
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-sm);
  position: relative;
  overflow: hidden;
  isolation: isolate;

  /* --- Typography --- */
  font-family: var(--font-family);
  font-size: var(--ms-md);
  font-weight: 500;
  line-height: 1;
  letter-spacing: var(--letter-spacing-wide);
  text-decoration: none;
  text-transform: none;
  white-space: nowrap;

  /* --- Spacing --- */
  --padding-y: 0.75em; /* Vertical padding relative to font-size */
  --padding-x: 1.5em;  /* Horizontal padding relative to font-size */
  padding: var(--padding-y) var(--padding-x);

  /* --- Visuals --- */
  background-color: var(--button-bg);
  color: var(--button-text);
  border: var(--border-width) solid var(--button-border-color);
  border-radius: var(--button-border-radius);

  /* --- Interaction --- */
  cursor: pointer;
  user-select: none;
  transition: all var(--transition-base);
}

/* ===================================================================
   INTERACTION STATES (Generic)
   =================================================================== */

/* --- Hover State --- */
/* Generic hover effects for all buttons (transform, shadow, etc.) */
.button:hover:not(:disabled) {
  color: var(--button-text-hover, var(--button-text));
  border-color: var(--button-border-color-hover, var(--button-border-color));
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

/* Specific background hover for NON-gradient buttons */
.button:not(.button--gradient):hover:not(:disabled) {
  background-color: var(--button-bg-hover);
}

/* --- Active State --- */
.button:active:not(:disabled) {
  transform: translateY(0);
  box-shadow: none;
}

/* --- Focus State --- */
.button:focus-visible {
  outline: none;
  box-shadow: 0 0 0 var(--space-xxs) var(--button-focus-color);
}

/* --- Disabled State --- */
.button:disabled {
  cursor: not-allowed;
  background-color: var(--color-disabled-bg);
  color: var(--color-disabled-text);
  border-color: transparent;
  box-shadow: none;
}

/* ===================================================================
   BUTTON VARIANTS (Color & Style)
   =================================================================== */

/* --- Filled Variants --- */
.button--secondary:not(.button--ghost):not(.button--light) {
  --button-bg: var(--color-secondary);
  --button-bg-hover: var(--color-secondary-dark);
  --button-focus-color: rgba(from var(--color-secondary) r g b / 0.5);
  --button-glow-color: var(--color-secondary);
  --button-gradient-start: var(--color-secondary);
  --button-gradient-end: var(--color-secondary-dark);
}

.button--info:not(.button--ghost):not(.button--light) {
  --button-bg: var(--color-info);
  --button-bg-hover: var(--color-info-dark);
  --button-focus-color: rgba(from var(--color-info) r g b / 0.5);
  --button-glow-color: var(--color-info);
  --button-gradient-start: var(--color-info);
  --button-gradient-end: var(--color-info-dark);
}

.button--notice:not(.button--ghost):not(.button--light) {
  --button-bg: var(--color-notice);
  --button-bg-hover: var(--color-notice-dark);
  --button-focus-color: rgba(from var(--color-notice) r g b / 0.5);
  --button-glow-color: var(--color-notice);
  --button-gradient-start: var(--color-notice);
  --button-gradient-end: var(--color-notice-dark);
}

.button--success:not(.button--ghost):not(.button--light) {
  --button-bg: var(--color-success);
  --button-bg-hover: var(--color-success-dark);
  --button-focus-color: rgba(from var(--color-success) r g b / 0.5);
  --button-glow-color: var(--color-success);
  --button-gradient-start: var(--color-success);
  --button-gradient-end: var(--color-success-dark);
}

.button--danger:not(.button--ghost):not(.button--light) {
  --button-bg: var(--color-danger);
  --button-bg-hover: var(--color-danger-dark);
  --button-focus-color: rgba(from var(--color-danger) r g b / 0.5);
  --button-glow-color: var(--color-danger);
  --button-gradient-start: var(--color-danger);
  --button-gradient-end: var(--color-danger-dark);
}

.button--warning:not(.button--ghost):not(.button--light) {
  --button-bg: var(--color-warning);
  --button-bg-hover: var(--color-warning-dark);
  --button-focus-color: rgba(from var(--color-warning) r g b / 0.5);
  --button-glow-color: var(--color-warning);
  --button-gradient-start: var(--color-warning);
  --button-gradient-end: var(--color-warning-dark);
}

.button--muted:not(.button--ghost):not(.button--light) {
  --button-bg: var(--color-muted);
  --button-bg-hover: var(--color-muted-dark);
  --button-focus-color: rgba(from var(--color-muted) r g b / 0.5);
  --button-glow-color: var(--color-muted);
  --button-gradient-start: var(--color-muted);
  --button-gradient-end: var(--color-muted-dark);
}

/* --- Ghost Variants --- */
.button--ghost {
  --button-bg: transparent;
  --button-text: var(--color-primary);
  --button-border-color: var(--color-primary);
  --button-bg-hover: var(--color-primary);
  --button-text-hover: var(--white);
  --button-border-color-hover: var(--color-primary);
}

.button--ghost.button--secondary {
  --button-text: var(--color-secondary);
  --button-border-color: var(--color-secondary);
  --button-bg-hover: var(--color-secondary);
  --button-border-color-hover: var(--color-secondary);
}

.button--ghost.button--info {
  --button-text: var(--color-info);
  --button-border-color: var(--color-info);
  --button-bg-hover: var(--color-info);
  --button-border-color-hover: var(--color-info);
}

.button--ghost.button--notice {
  --button-text: var(--color-notice);
  --button-border-color: var(--color-notice);
  --button-bg-hover: var(--color-notice);
  --button-border-color-hover: var(--color-notice);
}

.button--ghost.button--success {
  --button-text: var(--color-success);
  --button-border-color: var(--color-success);
  --button-bg-hover: var(--color-success);
  --button-border-color-hover: var(--color-success);
}

.button--ghost.button--danger {
  --button-text: var(--color-danger);
  --button-border-color: var(--color-danger);
  --button-bg-hover: var(--color-danger);
  --button-border-color-hover: var(--color-danger);
}

.button--ghost.button--warning {
  --button-text: var(--color-warning);
  --button-border-color: var(--color-warning);
  --button-bg-hover: var(--color-warning);
  --button-border-color-hover: var(--color-warning);
}

.button--ghost.button--muted {
  --button-text: var(--color-muted);
  --button-border-color: var(--color-muted);
  --button-bg-hover: var(--color-muted);
  --button-border-color-hover: var(--color-muted);
}

/* --- Outline Variant --- */
.button--outline {
  --button-bg: transparent;
  --button-text: var(--color-text);
  --button-border-color: var(--color-border);
  --button-bg-hover: var(--color-surface-hover);
  --button-border-color-hover: var(--color-border);
  --button-focus-color: rgba(from var(--color-text) r g b / 0.25);
}

/* --- Light Variants --- */
/* Base light style */
.button--light {
  border-color: transparent;
}

/* Light color variants */
.button--light.button--primary {
  --button-bg: var(--color-primary-light);
  --button-text: var(--color-primary-dark);
  --button-bg-hover: var(--color-primary);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-primary) r g b / 0.5);
  --button-glow-color: var(--color-primary);
  --button-gradient-start: var(--color-primary-light);
  --button-gradient-end: var(--color-primary);
}

.button--light.button--secondary {
  --button-bg: var(--color-secondary-light);
  --button-text: var(--color-secondary-dark);
  --button-bg-hover: var(--color-secondary);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-secondary) r g b / 0.5);
  --button-glow-color: var(--color-secondary);
  --button-gradient-start: var(--color-secondary-light);
  --button-gradient-end: var(--color-secondary);
}

.button--light.button--info {
  --button-bg: var(--color-info-light);
  --button-text: var(--color-info-dark);
  --button-bg-hover: var(--color-info);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-info) r g b / 0.5);
  --button-glow-color: var(--color-info);
  --button-gradient-start: var(--color-info-light);
  --button-gradient-end: var(--color-info);
}

.button--light.button--notice {
  --button-bg: var(--color-notice-light);
  --button-text: var(--color-notice-dark);
  --button-bg-hover: var(--color-notice);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-notice) r g b / 0.5);
  --button-glow-color: var(--color-notice);
  --button-gradient-start: var(--color-notice-light);
  --button-gradient-end: var(--color-notice);
}

.button--light.button--success {
  --button-bg: var(--color-success-light);
  --button-text: var(--color-success-dark);
  --button-bg-hover: var(--color-success);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-success) r g b / 0.5);
  --button-glow-color: var(--color-success);
  --button-gradient-start: var(--color-success-light);
  --button-gradient-end: var(--color-success);
}

.button--light.button--danger {
  --button-bg: var(--color-danger-light);
  --button-text: var(--color-danger-dark);
  --button-bg-hover: var(--color-danger);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-danger) r g b / 0.5);
  --button-glow-color: var(--color-danger);
  --button-gradient-start: var(--color-danger-light);
  --button-gradient-end: var(--color-danger);
}

.button--light.button--warning {
  --button-bg: var(--color-warning-light);
  --button-text: var(--color-warning-dark);
  --button-bg-hover: var(--color-warning);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-warning) r g b / 0.5);
  --button-glow-color: var(--color-warning);
  --button-gradient-start: var(--color-warning-light);
  --button-gradient-end: var(--color-warning);
}

.button--light.button--muted {
  --button-bg: var(--color-muted-light);
  --button-text: var(--color-muted-dark);
  --button-bg-hover: var(--color-muted);
  --button-text-hover: var(--white);
  --button-focus-color: rgba(from var(--color-muted) r g b / 0.5);
  --button-glow-color: var(--color-muted);
  --button-gradient-start: var(--color-muted-light);
  --button-gradient-end: var(--color-muted);
}

/* ===================================================================
   BUTTON SIZES
   =================================================================== */

.button--xs {
  font-size: var(--ms-xs);
  /* Border radius scales with font size */
}

.button--sm {
  font-size: var(--ms-sm);
  /* Border radius scales with font size */
}

.button--lg {
  font-size: var(--ms-lg);
  /* Border radius scales with font size */
}

.button--xl {
  font-size: var(--ms-xl);
  /* Border radius scales with font size */
}

.button--xxl {
  font-size: var(--ms-xxl);
  /* Border radius scales with font size */
  --padding-y: 1em;
  --padding-x: 1em;
}

/* ===================================================================
   BUTTON MODIFIERS
   =================================================================== */

.button--block {
  width: 100%;
}

.button--pill {
  border-radius: var(--radius-full);
}

.button--icon {
  padding: var(--space-sm);
  aspect-ratio: 1;
}

.button--icon.button--sm {
  padding: var(--space-xs);
}

.button--icon.button--lg {
  padding: var(--space-md);
}

/* ===================================================================
   MODERN EFFECTS
   =================================================================== */

/* --- Ripple Effect --- */
/* The ripple is a pseudo-element that scales up and fades in on click */
.button::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 100%;
  padding-top: 100%; /* Creates a circle with a responsive radius */
  border-radius: 50%;
  background-color: currentColor; /* Uses the button's text color for the ripple */
  opacity: 0;
  transform: translate(-50%, -50%) scale(0);
  /* This transition now applies to the effect animating in and out */
  transition: transform 0.4s ease-out, opacity 0.4s ease-out;
  pointer-events: none;
  z-index: 0; /* Places ripple behind the text */
}

/* Ensure button text and icons are on top of the ripple */
.button > * {
    position: relative;
    z-index: 1;
}

/* The ripple becomes visible and expands on click */
.button:active::before {
  transform: translate(-50%, -50%) scale(2);
  opacity: 0.3; /* Increased from 0.15 for better visibility */
}


/* --- Gradient Effect --- */
/* This now uses the button's existing variables to create a more prominent
   three-stop gradient, giving it a "shiny" look. */
.button--gradient {
  background: linear-gradient(
    135deg,
    color-mix(in oklab, var(--button-gradient-start) 80%, white 20%),
    var(--button-gradient-start) 50%,
    var(--button-gradient-end)
  );
  background-size: 200% 200%;
  animation: gradient-shift 3s ease infinite;
}

@keyframes gradient-shift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* --- Glow Effect --- */
/* Note: This will override the default lift shadow on hover */
.button--glow {
  box-shadow: 0 0 20px rgba(from var(--button-glow-color) r g b / 0.3);
}

.button--glow:hover:not(:disabled) {
  box-shadow: 0 0 30px rgba(from var(--button-glow-color) r g b / 0.5);
}

/* ===================================================================
   BUTTON GROUP
   =================================================================== */

.button-group {
  display: inline-flex;
  gap: -1px; /* Overlap borders */
}

.button-group .button {
  border-radius: 0;
}

.button-group .button:first-child {
  border-top-left-radius: var(--button-border-radius);
  border-bottom-left-radius: var(--button-border-radius);
}

.button-group .button:last-child {
  border-top-right-radius: var(--button-border-radius);
  border-bottom-right-radius: var(--button-border-radius);
}

.button-group .button:hover {
  z-index: 1;
}

/* ===================================================================
   LOADING STATE
   =================================================================== */

/* We hide the button's direct children (text, icons) instead of setting color to transparent.
   This allows the ::after pseudo-element to correctly inherit the original text color. */
.button--loading > * {
  visibility: hidden;
}

.button--loading {
  pointer-events: none;
}

/* The spinner correctly uses the button's text color (e.g., white) */
.button--loading::after {
  content: '';
  position: absolute;
  width: 1em;
  height: 1em;
  top: 50%;
  left: 50%;
  margin-left: -0.5em;
  margin-top: -0.5em;
  border: 0.15em solid currentColor;
  border-top-color: transparent;
  border-radius: var(--radius-full);
  animation: button-spin 0.6s linear infinite;
}

/* Keyframes for the spinning animation */
@keyframes button-spin {
  to { transform: rotate(360deg); }
}

/* ===================================================================
   BUTTON GROUP UTILITIES
   Flexible button groups for components
   =================================================================== */

.btn-group {
  display: flex;
  gap: var(--space-md);
  flex-wrap: wrap;
}

/* Alignment modifiers */
.btn-group--start {
  justify-content: flex-start;
}

.btn-group--center {
  justify-content: center;
}

.btn-group--end {
  justify-content: flex-end;
}

.btn-group--between {
  justify-content: space-between;
}

.btn-group--around {
  justify-content: space-around;
}

/* Direction modifiers */
.btn-group--vertical {
  flex-direction: column;
  align-items: center;
}

.btn-group--vertical .button {
  width: 100%;
  max-width: 300px;
}

/* Size modifiers */
.btn-group--sm {
  gap: var(--space-sm);
}

.btn-group--lg {
  gap: var(--space-lg);
}

/* Responsive behavior */
@media (max-width: 768px) {
  .mobile-full .button {
    width: 100% !important;
    max-width: 300px !important;
  }

  .btn-group--responsive {
    flex-direction: column !important;
    align-items: center !important;
  }

  .btn-group--responsive .button {
    width: 100% !important;
    max-width: 300px !important;
  }
}
